<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <title>HORIZONTE: SIMULADOR INVERSIONES</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;600&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://js.arcgis.com/4.32/esri/themes/dark/main.css">
    <script src="https://js.arcgis.com/4.32/"></script>

    <script type="module" src="https://js.arcgis.com/calcite-components/3.0.3/calcite.esm.js"></script>
    <link rel="stylesheet" type="text/css" href="https://js.arcgis.com/calcite-components/3.0.3/calcite.css" />
<link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="military-header">
        <div>
            <div class="military-title">HORIZONTE</div>
            <div class="military-subtitle">JUEGO DE ESTRATEGIA MULTIDIMENSIONAL</div>
        </div>
        <div id="currentDate" style="font-family: var(--font-monospace); font-size: 12px; opacity: 0.7;"></div>
    </div>

    <div class="container">
        <div id="controlPanel">
            <div class="panel-header">PANEL DE CONTROL</div>
<div class="legend-title">ESTADO DEL TERRITORIO</div>

            <!-- Barra continua -->
<div class="color-legend"></div>

<!-- Etiquetas -->
<div class="legend-labels">
    <span>Cr√≠tico</span>
    <span>√ìptimo</span>
</div>


            <div class="section-title">DIMENSIONES</div>

<!-- DIMENSI√ìN SEGURIDAD -->
<div class="dimension-container">
    <div class="dimension-header">
        <span class="dimension-name">SEGURIDAD</span>
    </div>
    <div class="dimension-control">
        <calcite-checkbox class="dimension-checkbox" id="seguridad-all"></calcite-checkbox>
        <div class="dimension-control-label">Seleccionar Todo / Ninguno</div>
    </div>

    <!-- Primeras 5 en orden especificado -->
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox seguridad-variable" id="seguridad-Homicidios"></calcite-checkbox>
        <div class="variable-name">Homicidios</div>
        <div class="info-icon" data-tooltip="Un gran numero de personas victimas de homicidio se asocia con condiciones de peligro en una regi√≥n, mientras que un numero bajo se asocia a una zona tranquila y segura." data-dimension="seguridad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox seguridad-variable" id="seguridad-EstacionesPolicia"></calcite-checkbox>
        <div class="variable-name">Estaciones de polic√≠a</div>
        <div class="info-icon" data-tooltip="M√°s estaciones de policia en la regi√≥n se asocian mayor presencia institucional, mientras que menos unidades reducen la capacidad de respuesta." data-dimension="seguridad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox seguridad-variable" id="seguridad-ExtorsionSecuestro"></calcite-checkbox>
        <div class="variable-name">Casos de extorsi√≥n y secuestro</div>
        <div class="info-icon" data-tooltip="Una alta cantidad de casos documentados incrementa el riesgo para comunidades y empresas, mientras que una baja incidencia favorece la estabilidad y la seguridad." data-dimension="seguridad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox seguridad-variable" id="seguridad-DelitosSexuales"></calcite-checkbox>
        <div class="variable-name">Casos relacionados con delitos sexuales</div>
        <div class="info-icon" data-tooltip="Una alta cantidad de delitos sexuales registrados refleja entornos inseguros, mientras que una baja ocurrencia sugiere condiciones de mayor seguridad." data-dimension="seguridad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox seguridad-variable" id="seguridad-MinasAntipersona"></calcite-checkbox>
        <div class="variable-name">Presencia de minas antipersona por Ha</div>
        <div class="info-icon" data-tooltip="Una gran extensi√≥n de hect√°reas con presencia de minas representa un alto riesgo humanitario, mientras que una menor √°rea sugiere condiciones de mayor seguridad territorial." data-dimension="seguridad">‚Ñπ</div>
    </div>
    
    <!-- Resto de variables de seguridad -->
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox seguridad-variable" id="seguridad-HomicidiosTransito"></calcite-checkbox>
        <div class="variable-name">Homicidios ocurridos por accidentes de tr√°nsito</div>
        <div class="info-icon" data-tooltip="Un gran numero de casos registrados se asocian a deficiencias en la infraestructura y en las medidas de prevenci√≥n, mientras que un n√∫mero reducido sugiere una movilidad m√°s segura y condiciones m√°s favorables." data-dimension="seguridad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox seguridad-variable" id="seguridad-LesionesPersonales"></calcite-checkbox>
        <div class="variable-name">Casos relacionados con lesiones personales</div>
        <div class="info-icon" data-tooltip="Un alto n√∫mero de casos de lesiones personales se relaciona con entornos comunitarios dificiles, mientras que un n√∫mero bajo indica mayor tranquilidad social." data-dimension="seguridad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox seguridad-variable" id="seguridad-LesionesTransito"></calcite-checkbox>
        <div class="variable-name">Casos relacionados con lesiones por accidentes de tr√°nsito</div>
        <div class="info-icon" data-tooltip="Muchos casos de lesiones por accidentes de transito reflejan escenarios de riesgo para la poblaci√≥n, mientras que pocos casos se sugieren condiciones mas seguras y controladas." data-dimension="seguridad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox seguridad-variable" id="seguridad-IncautacionCocaina"></calcite-checkbox>
        <div class="variable-name">Incautaciones de coca√≠na</div>
        <div class="info-icon" data-tooltip="Muchos kilogramos de coca√≠na incautados se asocian con presencia significativa de econom√≠as ilegales, mientras que incautaciones bajas indican menor presi√≥n criminal en el territorio." data-dimension="seguridad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox seguridad-variable" id="seguridad-IncautacionBaseCoca"></calcite-checkbox>
        <div class="variable-name">Incautaciones de base de coca</div>
        <div class="info-icon" data-tooltip="Muchos kilogramos de base de coca indican presencia representativa de econom√≠as ilegales, mientras que incautaciones bajas se asocian a mayor control de las estructuras criminales en la regi√≥n." data-dimension="seguridad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox seguridad-variable" id="seguridad-IncautacionBasuco"></calcite-checkbox>
        <div class="variable-name">Incautaciones de basuco</div>
        <div class="info-icon" data-tooltip="Incautaciones altas de kilogramos de basuco se relacionan con microtrafico extendido, mientras que incautaciones bajas se asocian a mayor control de economias criminales en la zona." data-dimension="seguridad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox seguridad-variable" id="seguridad-IncautacionArmas"></calcite-checkbox>
        <div class="variable-name">Incautaciones de armas de fuego</div>
        <div class="info-icon" data-tooltip="Mayores incautaciones de armas de fuego se asocian con un mayor nivel de riesgo para la poblaci√≥n, mientras que una menor cantidad sugiere menor circulaci√≥n ilegal en la zona." data-dimension="seguridad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox seguridad-variable" id="seguridad-MinasIntervenidas"></calcite-checkbox>
        <div class="variable-name">Minas antipersona intervenidas</div>
        <div class="info-icon" data-tooltip="Un alto n√∫mero de minas retiradas representa una recuperaci√≥n efectiva del territorio, mientras que una baja intervenci√≥n deja un riesgo latente para la poblaci√≥n." data-dimension="seguridad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox seguridad-variable" id="seguridad-CapturasMineria"></calcite-checkbox>
        <div class="variable-name">Capturas relacionadas con actividades en miner√≠a ilegal</div>
        <div class="info-icon" data-tooltip="Un alto n√∫mero de personas capturadas revela presencia activa de econom√≠as extractivas ilegales, mientras que un n√∫mero reducido sugiere menor actividad il√≠cita en la zona." data-dimension="seguridad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox seguridad-variable" id="seguridad-GruposArmados"></calcite-checkbox>
        <div class="variable-name">√çndice GAO ‚Äì guerrilla</div>
        <div class="info-icon" data-tooltip="Un √≠ndice alto expresa una fuerte influencia de grupos armados ilegales en el territorio, mientras que un √≠ndice bajo sugiere una presencia reducida de estos grupos." data-dimension="seguridad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox seguridad-variable" id="seguridad-PresenciaAreasBase"></calcite-checkbox>
        <div class="variable-name">√çndice ‚Äì ej√©rcito (√°reas base)</div>
        <div class="info-icon" data-tooltip="Un √≠ndice alto indica presencia institucional y control territorial, mientras que un √≠ndice bajo refleja capacidades limitadas de actuaci√≥n estatal en la zona" data-dimension="seguridad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox seguridad-variable" id="seguridad-Abigeato"></calcite-checkbox>
        <div class="variable-name">Casos de abigeato</div>
        <div class="info-icon" data-tooltip="Una alta incidencia de hurtos afecta la econom√≠a rural y deteriora la confianza en el territorio, mientras que una baja ocurrencia refleja un entorno seguro para las actividades agropecuarias." data-dimension="seguridad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox seguridad-variable" id="seguridad-MigracionIrregular"></calcite-checkbox>
        <div class="variable-name">Migraci√≥n irregular y trafico de migrantes</div>
        <div class="info-icon" data-tooltip="Un flujo alto de personas en situaci√≥n migratoria irregular ejerce mayor presion sobre el sistema territorial y proveedor de servicios esenciales, mientras que un flujo bajo facilita la gesti√≥n institucional." data-dimension="seguridad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox seguridad-variable" id="seguridad-ViolenciaTerrorista"></calcite-checkbox>
        <div class="variable-name">Atentados terroristas</div>
        <div class="info-icon" data-tooltip="Una alta cantidad de atentados representa una amenaza directa a la vida y a las condiciones para la inversi√≥n, mientras que una baja ocurrencia indica un contexto m√°s estable y seguro." data-dimension="seguridad">‚Ñπ</div>
    </div>
</div>

<!-- DIMENSI√ìN DESARROLLO -->
<div class="dimension-container">
    <div class="dimension-header">
        <span class="dimension-name">DESARROLLO</span>
    </div>
    <div class="dimension-control">
        <calcite-checkbox class="dimension-checkbox" id="desarrollo-all"></calcite-checkbox>
        <div class="dimension-control-label">Seleccionar Todo / Ninguno</div>
    </div>

    <!-- Primeras 5 en orden especificado -->
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox desarrollo-variable" id="desarrollo-NivelEducacion"></calcite-checkbox>
        <div class="variable-name">Asistencia escolar</div>
        <div class="info-icon" data-tooltip="Una alta asistencia escolar refleja compromiso social con las nuevas generaciones, mientras que una baja asistencia indica la presencia de barreras de acceso a la educaci√≥n en el territorio." data-dimension="desarrollo">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox desarrollo-variable" id="desarrollo-Alfabetismo"></calcite-checkbox>
        <div class="variable-name">Alfabetismo</div>
        <div class="info-icon" data-tooltip="Un mayor nivel de alfabetismo fortalece el capital humano y favorece el √©xito de los proyectos, mientras que un nivel bajo limita la adopci√≥n tecnol√≥gica y reduce el crecimiento social y economico de la poblaci√≥n." data-dimension="desarrollo">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox desarrollo-variable" id="desarrollo-AcueductoAlcantarillado"></calcite-checkbox>
        <div class="variable-name">Viviendas con acueducto y alcantarillado</div>
        <div class="info-icon" data-tooltip="Un mayor n√∫mero de viviendas con acceso a acueducto y alcantarillado mejora la salud p√∫blica y el entorno habitacional, mientras que una baja cobertura implica riesgo sanitario y mayores costos para la poblaci√≥n." data-dimension="desarrollo">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox desarrollo-variable" id="desarrollo-EnergiaElectrica"></calcite-checkbox>
        <div class="variable-name">Viviendas con energ√≠a el√©ctrica</div>
        <div class="info-icon" data-tooltip="Un suministro el√©ctrico confiable impulsa la productividad y mejora la calidad de vida, mientras que la carencia o intermitencia del servicio limita el desarrollo econ√≥mico del territorio." data-dimension="desarrollo">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox desarrollo-variable" id="desarrollo-Gas"></calcite-checkbox>
        <div class="variable-name">Viviendas con gas domiciliario</div>
        <div class="info-icon" data-tooltip="La cobertura de gas domiciliario aporta una fuente de energ√≠a limpia y reduce los riesgos en el entorno dom√©stico, mientras que su ausencia incrementa la vulnerabilidad energ√©tica del territorio." data-dimension="desarrollo">‚Ñπ</div>
    </div>
    
    <!-- Resto de variables de desarrollo -->
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox desarrollo-variable" id="desarrollo-Internet"></calcite-checkbox>
        <div class="variable-name">Viviendas con acceso a internet</div>
        <div class="info-icon" data-tooltip="Una buena conectividad a internet mejora el acceso a educaci√≥n, servicios y oportunidades productivas, mientras que una conectividad deficiente limita la inclusi√≥n digital y el desarrollo local." data-dimension="desarrollo">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox desarrollo-variable" id="desarrollo-AmenazaDeslizamiento"></calcite-checkbox>
        <div class="variable-name">Amenaza por deslizamiento de tierras</div>
        <div class="info-icon" data-tooltip="Una alta frecuencia de alertas geol√≥gicas se asocia con mayor riesgo f√≠sico y mayores costos de mitigaci√≥n, mientras que una baja frecuencia sugiere condiciones de terreno m√°s estables." data-dimension="desarrollo">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox desarrollo-variable" id="desarrollo-AlertasHidrologicas"></calcite-checkbox>
        <div class="variable-name">Amenaza por fenomenos hidrologicos</div>
        <div class="info-icon" data-tooltip="Una alta recurrencia de inundaciones amenaza la infraestructura y la continuidad operativa, mientras que una baja recurrencia indica un riesgo hidrologico moderado." data-dimension="desarrollo">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox desarrollo-variable" id="desarrollo-AlertasIncendios"></calcite-checkbox>
        <div class="variable-name">Amenaza de incendios en cobertura vegetal</div>
        <div class="info-icon" data-tooltip="Una alta cantidad de alertas por incendios forestales revela vulnerabilidad ambiental en el territorio, mientras que una baja ocurrencia sugiere ecosistemas menos propensos a incendios." data-dimension="desarrollo">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox desarrollo-variable" id="desarrollo-BajoPesoNacer"></calcite-checkbox>
        <div class="variable-name">Tasa de bajo peso al nacer</div>
        <div class="info-icon" data-tooltip="Una tasa elevada se√±ala deficiencias nutricionales y riesgos para la salud infantil, mientras que una tasa baja denota condiciones sanitarias m√°s favorables." data-dimension="desarrollo">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox desarrollo-variable" id="desarrollo-DesnutricionAguda"></calcite-checkbox>
        <div class="variable-name">Tasa de desnutrici√≥n aguda</div>
        <div class="info-icon" data-tooltip="Una alta tasa de desnutrici√≥n evidencia una situaci√≥n cr√≠tica en materia de seguridad alimentaria, mientras que una baja tasa indica una poblaci√≥n con mejores condiciones nutricionales." data-dimension="desarrollo">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox desarrollo-variable" id="desarrollo-TasaOcupacion"></calcite-checkbox>
        <div class="variable-name">Tasa de desempleo</div>
        <div class="info-icon" data-tooltip="Una alta tasa de desempleo refleja fragilidad econ√≥mica y menor capacidad de ingreso para la poblaci√≥n, mientras que una baja tasa impulsa el desarrollo economico y aporta a la estabilidad territorial." data-dimension="desarrollo">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox desarrollo-variable" id="desarrollo-IPM"></calcite-checkbox>
        <div class="variable-name">Indice de pobreza multidimensional</div>
        <div class="info-icon" data-tooltip="Un  IPM alto revela m√∫ltiples carencias estructurales en el territorio, mientras que un IPM bajo evidencia mejores condiciones de bienestar y calidad de vida." data-dimension="desarrollo">‚Ñπ</div>
    </div>
</div>

<!-- DIMENSI√ìN GOBERNABILIDAD -->
<div class="dimension-container">
    <div class="dimension-header">
        <span class="dimension-name">GOBERNABILIDAD</span>
    </div>
    <div class="dimension-control">
        <calcite-checkbox class="dimension-checkbox" id="gobernabilidad-all"></calcite-checkbox>
        <div class="dimension-control-label">Seleccionar Todo / Ninguno</div>
    </div>

    <!-- Primeras 5 en orden especificado -->
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox gobernabilidad-variable" id="gobernabilidad-CensoPoblacional"></calcite-checkbox>
        <div class="variable-name">Poblaci√≥n total</div>
        <div class="info-icon" data-tooltip="Una mayor poblaci√≥n puede representar un entorno din√°mico con mayor demanda de servicios y oferta laboral, mientras que una poblaci√≥n muy baja puede limitar el desarrollo territorial y la viabilidad de inversiones." data-dimension="gobernabilidad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox gobernabilidad-variable" id="gobernabilidad-InstitucionesEducativas"></calcite-checkbox>
        <div class="variable-name">Instituciones educativas</div>
        <div class="info-icon" data-tooltip="Una amplia oferta educativa fomenta el desarrollo del capital humano y fortalece la cohesi√≥n social, mientras que su escasez obstaculiza el desarrollo del territorio." data-dimension="gobernabilidad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox gobernabilidad-variable" id="gobernabilidad-InstitucionesSalud"></calcite-checkbox>
        <div class="variable-name">Instituciones de salud</div>
        <div class="info-icon" data-tooltip="Un mayor numero de centros de salud mejoran el acceso para la poblaci√≥n en temas medicos, mientras que una baja disponibilidad de incrementa el riesgo por situaciones de salud no tratadas." data-dimension="gobernabilidad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox gobernabilidad-variable" id="gobernabilidad-AreasProtegidas"></calcite-checkbox>
        <div class="variable-name">√Åreas protegidas</div>
        <div class="info-icon" data-tooltip="Una mayor extensi√≥n de √°reas protegidas contribuye a la preservaci√≥n de ecosistemas vitales y fomenta el turismo sostenible, mientras que una baja cobertura incrementa el riesgo de degradaci√≥n ambiental." data-dimension="gobernabilidad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox gobernabilidad-variable" id="gobernabilidad-ReservasIndigenas"></calcite-checkbox>
        <div class="variable-name">Reservas indigenas</div>
        <div class="info-icon" data-tooltip="La existencia de reservas indigenas respaldan la autonom√≠a cultural y derechos territoriales, mentras que la ausencia de reservas en territorios en disputa se asocian a conflictos por la tierra." data-dimension="gobernabilidad">‚Ñπ</div>
    </div>
    
    <!-- Resto de variables de gobernabilidad -->
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox gobernabilidad-variable" id="gobernabilidad-ComunidadesNegras"></calcite-checkbox>
        <div class="variable-name">Territorios colectivos de comunidades negras</div>
        <div class="info-icon" data-tooltip="La existencia de TCCN fortalecen los derechos colectivos y la gobernanza √©tnica, mientras que una baja protecci√≥n territorial refleja un d√©ficit en inclusi√≥n y reconocimiento institucional." data-dimension="gobernabilidad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox gobernabilidad-variable" id="gobernabilidad-DesarrolloTuristico"></calcite-checkbox>
        <div class="variable-name">Prestadores tur√≠sticos</div>
        <div class="info-icon" data-tooltip="Una alta presencia de prestadores tur√≠sticos dinamiza la econom√≠a local y promueve el empleo, mientras que su escasez limita la diversificaci√≥n y el crecimiento de la regi√≥n." data-dimension="gobernabilidad">‚Ñπ</div>
    </div>
    <div class="variable-item">
        <calcite-checkbox class="variable-checkbox gobernabilidad-variable" id="gobernabilidad-Hoteles"></calcite-checkbox>
        <div class="variable-name">Hoteles</div>
        <div class="info-icon" data-tooltip="La presencia de m√∫ltiples hoteles incrementa la capacidad de alojamiento y fortalece la confianza inversionista, mientras que una oferta limitada restringe el flujo tur√≠stico y las oportunidades de desarrollo." data-dimension="gobernabilidad">‚Ñπ</div>
    </div>
</div>

            

            <div class="panel-footer" style="display: none;">
                <calcite-button onclick="window.showSelectionStats?.()" appearance="outline" color="blue">VER ESTAD√çSTICAS</calcite-button>
                <calcite-button onclick="window.getServiceInfo?.()" appearance="outline" color="neutral">INFO SERVICIO</calcite-button>
                <calcite-button id="resetBtn" appearance="outline" color="red">REINICIAR SISTEMA</calcite-button>
            </div>
        </div>

        <div id="viewDiv"></div>
    </div>

    <div id="loadingIndicator">
        <div class="loading-spinner"></div>
        <span>Procesando An√°lisis Multidimensional...</span>
    </div>

    <div id="statusLog" class="info">Inicializando HORIZONTE 2.0...</div>

    <script src="script.js"></script>
    <script src="layer-connections.js"></script>
    <script src="variable-scale-config.js"></script>


    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Manejadores para los checkboxes principales (dimensiones)
        const dimensionCheckboxes = document.querySelectorAll('.dimension-checkbox');

        dimensionCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('calciteCheckboxChange', function(event) {
                const dimensionId = checkbox.id.split('-')[0];
                const isChecked = event.target.checked;

                // Seleccionar todos los checkboxes de variables de esta dimensi√≥n
                const variableCheckboxes = document.querySelectorAll(`.${dimensionId}-variable`);

                variableCheckboxes.forEach(varCheckbox => {
                    varCheckbox.checked = isChecked;

                    // Disparar eventos para asegurar sincronizaci√≥n
                    const changeEvent = new Event('change', { bubbles: true });
                    varCheckbox.dispatchEvent(changeEvent);

                    varCheckbox.dispatchEvent(new CustomEvent('calciteCheckboxChange', {
                        bubbles: true,
                        detail: { checked: isChecked }
                    }));
                });

                if (window.toggleDimensionLayers) {
                    window.toggleDimensionLayers(dimensionId, isChecked);
                }
            });
        });

        // Funci√≥n para actualizar el estado del checkbox principal
        const updateDimensionCheckbox = (dimensionId) => {
            const allVarCheckboxes = document.querySelectorAll(`.${dimensionId}-variable`);
            const checkedVarCheckboxes = Array.from(allVarCheckboxes).filter(checkbox => checkbox.checked);
            const dimensionCheckbox = document.getElementById(`${dimensionId}-all`);

            if (!dimensionCheckbox) return;

            if (checkedVarCheckboxes.length === 0) {
                dimensionCheckbox.checked = false;
                dimensionCheckbox.indeterminate = false;
            } else if (checkedVarCheckboxes.length === allVarCheckboxes.length) {
                dimensionCheckbox.checked = true;
                dimensionCheckbox.indeterminate = false;
            } else {
                dimensionCheckbox.indeterminate = true;
            }
        };

        // A√±adir listeners a checkboxes de variables individuales
        ['seguridad', 'desarrollo', 'gobernabilidad'].forEach(dimensionId => {
            const variableCheckboxes = document.querySelectorAll(`.${dimensionId}-variable`);

            variableCheckboxes.forEach(checkbox => {
                checkbox.addEventListener('calciteCheckboxChange', () => {
                    updateDimensionCheckbox(dimensionId);
                });
            });

            // Inicializar estado
            updateDimensionCheckbox(dimensionId);
        });

        // Funci√≥n para actualizar el estado del servicio en la UI
        window.updateServiceStatus = function() {
            const primaryStatusElement = document.getElementById('primaryServiceStatus');
            if (primaryStatusElement && window.horizonte?.currentServiceURL) {
                // Obtener las URLs de servicio desde el script principal
                const primaryURL = "https://geocntr-imagery.bd.esri.com/server/rest/services/Colombia/Dimensiones_Scaled/ImageServer";
                const isPrimary = window.horizonte.currentServiceURL === primaryURL;
                
                if (isPrimary) {
                    primaryStatusElement.textContent = 'ACTIVO';
                    primaryStatusElement.style.color = 'var(--success-color)';
                } else {
                    primaryStatusElement.textContent = 'NO DISPONIBLE';
                    primaryStatusElement.style.color = 'var(--error-color)';
                }
            }
        };

        // Escuchar cuando el sistema est√© listo para actualizar el estado
        window.addEventListener('horizonte:systemReady', function() {
            setTimeout(() => {
                window.updateServiceStatus?.();
            }, 500);
        });

        // Sistema de tooltips mejorado con barras de simbolog√≠a
        const infoIcons = document.querySelectorAll('.info-icon');
        const tooltip = document.createElement('div');
        const tooltipArrow = document.createElement('div');
        
        tooltip.className = 'custom-tooltip';
        tooltipArrow.className = 'custom-tooltip-arrow';
        
        document.body.appendChild(tooltip);
        document.body.appendChild(tooltipArrow);
        
        // Funci√≥n para obtener el ID de la variable desde el checkbox m√°s cercano
        function getVariableId(infoIcon) {
            const variableItem = infoIcon.closest('.variable-item');
            if (variableItem) {
                const checkbox = variableItem.querySelector('.variable-checkbox');
                if (checkbox) {
                    return checkbox.id;
                }
            }
            return null;
}
        
        // Funci√≥n para crear el contenido del tooltip con barra de simbolog√≠a
        function createTooltipContent(text, dimension, variableId) {
            const isSecurityDimension = dimension === 'seguridad';
            const isInvertedScale = window.variableScaleConfig ? 
                window.variableScaleConfig.tieneEscalaInvertida(variableId) : 
                false;
            
            // Determinar qu√© barra de color usar
            let barClass;
            let leftLabel, rightLabel, leftValue, rightValue;
            
            if (isInvertedScale) {
                // Variables con escala invertida SIEMPRE usan barra amarillo-verde
                barClass = 'development';
                leftLabel = 'BAJO';
                rightLabel = 'ALTO';
                leftValue = '(NEGATIVO)';
                rightValue = '(POSITIVO)';
            } else {
                // Variables normales usan la barra seg√∫n su dimensi√≥n
                if (isSecurityDimension) {
                    barClass = 'security';
                    leftLabel = 'BAJO';
                    rightLabel = 'ALTO';
                    leftValue = '(POSITIVO)';
                    rightValue = '(NEGATIVO)';
                } else {
                    // Para desarrollo y gobernabilidad normales
                    barClass = 'security'; // Usan barra rojo-amarillo
                    leftLabel = 'ALTO';
                    rightLabel = 'BAJO';
                    leftValue = '(NEGATIVO)';
                    rightValue = '(POSITIVO)';
                }
            }
            
            return `
                <div>${text}</div>
                <div class="tooltip-symbology">
                    <div class="symbology-label">INTERPRETACI√ìN DE VALORES</div>
                    <div class="symbology-bar ${barClass}">
                        <div class="symbology-indicator"></div>
                    </div>
                    <div class="symbology-labels">
                        <span>${leftLabel} <small>${leftValue}</small></span>
                        <span>${rightLabel} <small>${rightValue}</small></span>
                    </div>
                </div>
            `;
        }
        
        infoIcons.forEach(icon => {
            icon.addEventListener('mouseenter', function(e) {
                const rect = icon.getBoundingClientRect();
                const tooltipText = icon.getAttribute('data-tooltip');
                const dimension = icon.getAttribute('data-dimension');
                
                const variableId = getVariableId(icon);
                tooltip.innerHTML = createTooltipContent(tooltipText, dimension, variableId);
                tooltip.style.opacity = '0';
                tooltip.style.visibility = 'visible';
                
                // Calcular posici√≥n
                const tooltipRect = tooltip.getBoundingClientRect();
                const windowWidth = window.innerWidth;
                const windowHeight = window.innerHeight;
                
                let left = rect.right + 10;
                let top = rect.top + (rect.height / 2) - (tooltipRect.height / 2);
                
                // Verificar si se sale por la derecha
                if (left + tooltipRect.width > windowWidth - 20) {
                    left = rect.left - tooltipRect.width - 10;
                    tooltipArrow.style.borderRightColor = 'transparent';
                    tooltipArrow.style.borderLeftColor = '#517f35';
                    tooltipArrow.style.left = (left + tooltipRect.width + 4) + 'px';
                } else {
                    tooltipArrow.style.borderLeftColor = 'transparent';
                    tooltipArrow.style.borderRightColor = '#517f35';
                    tooltipArrow.style.left = (left - 6) + 'px';
                }
                
                // Verificar si se sale por abajo
                if (top + tooltipRect.height > windowHeight - 20) {
                    top = windowHeight - tooltipRect.height - 20;
                }
                
                // Verificar si se sale por arriba
                if (top < 20) {
                    top = 20;
                }
                
                tooltip.style.left = left + 'px';
                tooltip.style.top = top + 'px';
                tooltipArrow.style.top = (rect.top + rect.height / 2 - 6) + 'px';
                
                // Mostrar con animaci√≥n
                setTimeout(() => {
                    tooltip.style.opacity = '1';
                    tooltipArrow.style.opacity = '1';
                    tooltipArrow.style.visibility = 'visible';
                }, 10);
            });
            
            icon.addEventListener('mouseleave', function() {
                tooltip.style.opacity = '0';
                tooltip.style.visibility = 'hidden';
                tooltipArrow.style.opacity = '0';
                tooltipArrow.style.visibility = 'hidden';
            });
        });

        console.log("üöÄ HORIZONTE 2.0 - Interfaz inicializada con barras de simbolog√≠a");
    });
    </script>

</body>
</html>